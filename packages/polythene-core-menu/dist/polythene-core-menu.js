!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("polythene-core")):"function"==typeof define&&define.amd?define(["exports","polythene-core"],t):t((e=e||self).polythene={},e["polythene-core"])}(this,(function(e,t){"use strict";function n(){return(n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e}).apply(this,arguments)}function o(e,t){if(null==e)return{};var n,o,r=function(e,t){if(null==e)return{};var n,o,r={},i=Object.keys(e);for(o=0;o<i.length;o++)n=i[o],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function r(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],o=!0,r=!1,i=void 0;try{for(var a,l=e[Symbol.iterator]();!(o=(a=l.next()).done)&&(n.push(a.value),!t||n.length!==t);o=!0);}catch(e){r=!0,i=e}finally{try{o||null==l.return||l.return()}finally{if(r)throw i}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var i={component:"pe-menu",panel:"pe-menu__panel",content:"pe-menu__content",placeholder:"pe-menu__placeholder",backdrop:"pe-menu__backdrop",floating:"pe-menu--floating",origin:"pe-menu--origin",permanent:"pe-menu--permanent",showBackdrop:"pe-menu--backdrop",visible:"pe-menu--visible",width_auto:"pe-menu--width-auto",width_n:"pe-menu--width-",isTopMenu:"pe-menu--top-menu",listTile:"pe-list-tile",selectedListTile:"pe-list-tile--selected"};e._Menu=function(e){var a=e.h,l=e.a,s=e.useReducer,u=e.useState,c=e.useEffect,p=e.useRef,f=e.getRef,d=e.Shadow,h=o(e,["h","a","useReducer","useState","useEffect","useRef","getRef","Shadow"]),g=r(s(t.transitionStateReducer,t.initialTransitionState),2)[1],m=r(u(),2),y=m[0],v=m[1],b=r(u(!!h.permanent),2)[1],w=p(),S=p(),x=function(){O(),R()},E=function(e){var t=e.isShow,o=e.hideDelay,r=void 0===o?h.hideDelay:o;return{dispatchTransitionState:g,setIsVisible:b,props:n({},h,{hideDelay:r}),isShow:t,beforeTransition:t?function(){return x()}:null,domElements:{el:w.current,showClassElement:y},showClass:i.visible}},O=function(){if(!t.isServer&&h.target){var e=w.current,o=S.current,r=document.querySelector(h.target);if(r&&e){var a=t.stylePropCompare({element:e,prop:"position",equals:"fixed"});if(a&&!h.topMenu&&!t.stylePropCompare({element:y,pseudoSelector:":before",prop:"content",contains:'"'.concat("top_menu",'"')}))return n(e.style,{}),void e.offsetHeight;var l=e.parentNode.getBoundingClientRect(),s=r.getBoundingClientRect(),u=void 0!==h.offsetH?h.offsetH:void 0!==h.offset?h.offset:0,c=void 0!==h.offsetV?h.offsetV:"79%",p=-1!==u.toString().indexOf("%")?Math.round(.01*parseFloat(u)*s.width):Math.round(parseFloat(u)),f=-1!==c.toString().indexOf("%")?Math.round(.01*parseFloat(c)*s.height):Math.round(parseFloat(c)),d=h.origin||"top",g=d.split(/\W+/).reduce((function(e,t){return e[t]=!0,e}),{}),m=o.querySelectorAll("."+i.listTile)[0];if(h.reposition){var v=o.querySelector("."+i.selectedListTile);if(m&&v){var b=m.getBoundingClientRect(),x=v.getBoundingClientRect();f=b.top-x.top}var E=(v||m).getBoundingClientRect(),O=r.getBoundingClientRect().height-E.height;f+=Math.abs(O)/2}else h.origin&&!a&&(g.top?f+=s.top-l.top:g.bottom&&(f+=s.top-l.bottom));if(h.height){var R=m?m.clientHeight:48;if("max"===h.height){var T=f,_=R;e.style.height="calc(100% - ".concat(T+_,"px)")}else{var k=/^\d+$/.test(h.height.toString())?"".concat(h.height,"px"):h.height;e.style.height=k}}var D=e.style.transitionDuration;e.style.transitionDuration="0ms",e.parentNode&&!a&&(g.right?e.style.right=s.right-l.right+p+"px":e.style.left=s.left-l.left+p+"px",g.bottom?e.style.bottom=f+"px":e.style.top=f+"px",e.style.transformOrigin=d.split(/\W+/).join(" ")),e.offsetHeight,e.style.transitionDuration=D}}},R=function(){if(!t.isServer&&h.scrollTarget){var e=document.querySelector(h.scrollTarget);e&&(S.current.scrollTop=e.offsetTop)}},T=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.hideDelay;return t.transitionComponent(E({isShow:!1,hideDelay:n}))};c((function(){if(y){w.current=y.querySelector(".".concat(i.panel)),n(w.current.style,h.style),S.current=y.querySelector(".".concat(i.content));var e=function(e){"Escape"!==e.key&&"Esc"!==e.key||T({hideDelay:0})},o=function(e){e.target!==w.current&&T()};return h.permanent||(t.subscribe("resize",x),t.subscribe("keydown",e),setTimeout((function(){t.pointerEndDownEvent.forEach((function(e){return document.addEventListener(e,o)})),t.transitionComponent(E({isShow:!0}))}),0)),function(){h.permanent||(t.unsubscribe("resize",x),t.unsubscribe("keydown",e),t.pointerEndDownEvent.forEach((function(e){return document.removeEventListener(e,o)})))}}}),[y]);var _,k,D=h.type||"floating",C=n({},t.filterSupportedAttributes(h,{remove:["style"]}),h.testId&&{"data-test-id":h.testId},f((function(e){return e&&!y&&(v(e),h.getRef&&h.getRef(e))})),{className:[i.component,h.permanent?i.permanent:null,h.origin?i.origin:null,h.backdrop?i.showBackdrop:null,h.topMenu?i.isTopMenu:null,"floating"!==D||h.permanent?null:i.floating,h.width||h.size?(k=h.width||h.size,_=k<1.5?1.5:k,i.width_n+_.toString().replace(".","-")):null,"dark"===h.tone?"pe-dark-tone":null,"light"===h.tone?"pe-light-tone":null,h.className||h[l.class]].join(" ")}),M=void 0!==h.shadowDepth?h.shadowDepth:1,j=[a("div",{className:i.backdrop}),a("div",{className:i.panel},[a(d,{shadowDepth:M,animated:!0}),a("div",{className:i.content},h.content||h.children)])],q=[h.before].concat(j,[h.after]);return a(h.element||"div",C,q)},Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=polythene-core-menu.js.map
